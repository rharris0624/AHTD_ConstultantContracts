<?xml version="1.0"?>
<configuration>
	<configSections>
		<sectionGroup name="system.web.extensions" type="System.Web.Configuration.SystemWebExtensionsSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
			<sectionGroup name="scripting" type="System.Web.Configuration.ScriptingSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
				<section name="scriptResourceHandler" type="System.Web.Configuration.ScriptingScriptResourceHandlerSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication" />
				<sectionGroup name="webServices" type="System.Web.Configuration.ScriptingWebServicesSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
					<section name="jsonSerialization" type="System.Web.Configuration.ScriptingJsonSerializationSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="Everywhere" />
					<section name="profileService" type="System.Web.Configuration.ScriptingProfileServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication" />
					<section name="authenticationService" type="System.Web.Configuration.ScriptingAuthenticationServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication" />
					<section name="roleService" type="System.Web.Configuration.ScriptingRoleServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication" />
				</sectionGroup>
			</sectionGroup>
		</sectionGroup>
		<sectionGroup name="passiveClaimsSettings">
			<section name="FabrikamAirlinesWebSite" type="System.Configuration.NameValueSectionHandler" />
		</sectionGroup>
		<sectionGroup name="appRoleDefinitions">
			<section name="FabrikamAirlinesWebSite" type="System.Configuration.NameValueSectionHandler" />
		</sectionGroup>
		<sectionGroup name="elmah">
			<section name="security" requirePermission="false" type="Elmah.SecuritySectionHandler, Elmah" />
			<section name="errorLog" requirePermission="false" type="Elmah.ErrorLogSectionHandler, Elmah" />
			<section name="errorMail" requirePermission="false" type="Elmah.ErrorMailSectionHandler, Elmah" />
			<section name="errorFilter" requirePermission="false" type="Elmah.ErrorFilterSectionHandler, Elmah" />
		</sectionGroup>
		<sectionGroup name="applicationSettings" type="System.Configuration.ApplicationSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
			<section name="AHTD.Security.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
		</sectionGroup>
		<section name="microsoft.identityModel" type="Microsoft.IdentityModel.Configuration.MicrosoftIdentityModelSection, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
	</configSections>
	<appSettings>
		<add key="IssuerName" value="AHTD_STS" />
		<add key="SigningCertificateName" value="CN=STSTestCert" />
		<add key="EncryptingCertificateName" value="CN=DefaultApplicationCertificate" />
		<add key="FederationMetadataLocation" value="http://localhost/stsweb/FederationMetadata/2007-06/FederationMetadata.ashx" />
	</appSettings>
	<connectionStrings>
		<add name="AHPDBProd" connectionString="Data Source=DBPROD2005;Initial Catalog=HighwayPolice;Integrated Security=True;Application Name=STSWeb;" providerName="System.Data.SqlClient" />
		<add name="AHPDBTest" connectionString="Data Source=DOTNETAD;Initial Catalog=HighwayPolice;Integrated Security=True;Application Name=STSWeb;" providerName="System.Data.SqlClient" />
		<add name="UsrProvDBProd" connectionString="Data Source=DBPROD2005;Initial Catalog=AHTDDirectory;Integrated Security=True;Application Name=STSWeb;" providerName="System.Data.SqlClient" />
		<add name="UsrProvDBTest" connectionString="Data Source=DOTNETAD;Initial Catalog=AHTDDirectory;Integrated Security=True;Application Name=STSWeb;" providerName="System.Data.SqlClient" />
		<add name="ELMAH.SQLite" connectionString="Data Source=~/App_Data/errorLog.db" />
	</connectionStrings>
	<location path="FederationMetadata">
		<system.web>
			<authorization>
				<allow users="*" />
			</authorization>
		</system.web>
	</location>
	<system.web>
		<compilation debug="true">
			<assemblies>
				<add assembly="System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
				<add assembly="System.Data.DataSetExtensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
				<add assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
				<add assembly="System.Xml.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
				<add assembly="Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
			</assemblies>
		</compilation>
		<authentication mode="Windows" />
		<identity impersonate="false" />
		<authorization>
			<deny users="?" />
		</authorization>
		<pages>
			<controls>
				<add tagPrefix="asp" namespace="System.Web.UI" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
				<add tagPrefix="asp" namespace="System.Web.UI.WebControls" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
			</controls>
		</pages>
		<httpHandlers>
			<remove verb="*" path="*.asmx" />
			<add verb="*" path="*.asmx" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
			<add verb="*" path="*_AppService.axd" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
			<add verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" validate="false" />
			<add verb="POST,GET,HEAD" path="admin/errorLog.aspx" type="Elmah.ErrorLogPageFactory, Elmah" />
		</httpHandlers>
		<httpModules>
			<add name="ScriptModule" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
			<add name="ErrorLog" type="Elmah.ErrorLogModule, Elmah" />
		</httpModules>
	</system.web>
	<system.codedom>
		<compilers>
			<compiler language="c#;cs;csharp" extension=".cs" warningLevel="4" type="Microsoft.CSharp.CSharpCodeProvider, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
				<providerOption name="CompilerVersion" value="v3.5" />
				<providerOption name="WarnAsError" value="false" />
			</compiler>
		</compilers>
	</system.codedom>
	<system.webServer>
		<validation validateIntegratedModeConfiguration="false" />
		<modules>
			<remove name="ScriptModule" />
			<add name="ScriptModule" preCondition="managedHandler" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
			<add name="ErrorLog" type="Elmah.ErrorLogModule, Elmah" />
		</modules>
		<handlers>
			<remove name="WebServiceHandlerFactory-Integrated" />
			<remove name="ScriptHandlerFactory" />
			<remove name="ScriptHandlerFactoryAppServices" />
			<remove name="ScriptResource" />
			<add name="ScriptHandlerFactory" verb="*" path="*.asmx" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
			<add name="ScriptHandlerFactoryAppServices" verb="*" path="*_AppService.axd" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
			<add name="ScriptResource" preCondition="integratedMode" verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
			<add name="ErrorLog" verb="POST,GET,HEAD" preCondition="integratedMode" path="admin/errorLog.aspx" type="Elmah.ErrorLogPageFactory, Elmah" />
		</handlers>
	</system.webServer>
	<runtime>
		<assemblyBinding appliesTo="v2.0.50727" xmlns="urn:schemas-microsoft-com:asm.v1">
			<dependentAssembly>
				<assemblyIdentity name="System.Web.Extensions" publicKeyToken="31bf3856ad364e35" />
				<bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0" />
			</dependentAssembly>
			<dependentAssembly>
				<assemblyIdentity name="System.Web.Extensions.Design" publicKeyToken="31bf3856ad364e35" />
				<bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0" />
			</dependentAssembly>
		</assemblyBinding>
	</runtime>
	<!-- 
	Uncomment the lines below to enable WIF tracing to: WIFTrace.e2e. 
	Open the trace file using the SvcTraceViewer.exe tool (shipped with the WCF SDK available from Microsoft) or a xml viewer.
	Refer to MSDN if you wish to add WCF tracing.
	-->
	<!--<system.diagnostics>
		<sources>
			<source name="Microsoft.IdentityModel" switchValue="Verbose">
				<listeners>
					<add name="xml" type="System.Diagnostics.XmlWriterTraceListener" initializeData="WIFTrace.e2e" />
				</listeners>
			</source>
		</sources>
		<trace autoflush="true" />
	</system.diagnostics>-->
	<elmah>
		<errorLog type="Elmah.SQLiteErrorLog, Elmah" connectionStringName="ELMAH.SQLite" />
		<!--
			It is okay to leave this on, even in prod, as we control
			access in a location block below.
		-->
		<security allowRemoteAccess="1" />
	</elmah>
	<location path="admin">
		<system.web>
			<authorization>
				<deny users="?" />
				<allow roles="AHTD\CSD Applications" />
				<deny users="*" />
			</authorization>
		</system.web>
	</location>
	<passiveClaimsSettings>
		<FabrikamAirlinesWebSite>
			<add key="http://schemas.microsoft.com/ws/2008/06/identity/claims/windowsaccountname" value="" />
			<add key="http://schemas.microsoft.com/ws/2008/06/identity/claims/role" value="" />
		</FabrikamAirlinesWebSite>
	</passiveClaimsSettings>
	<appRoleDefinitions>
		<FabrikamAirlinesWebSite>
			<add key="App_CSRunbks_AppDev_Prod" value="" />
			<add key="App_CSRunbks_AppDev_Test" value="" />
			<add key="App_CSRunbks_ApprovalAD_Prod" value="" />
			<add key="App_CSRunbks_ApprovalAD_Test" value="" />
			<add key="App_CSRunbks_ApprovalCA7_Prod" value="" />
			<add key="App_CSRunbks_ApprovalCA7_Test" value="" />
			<add key="App_CSRunbks_ApprovalPC_Prod" value="" />
			<add key="App_CSRunbks_ApprovalPC_Test" value="" />
			<add key="App_CSRunbks_Dev_Prod" value="" />
			<add key="App_CSRunbks_Dev_Test" value="" />
			<add key="App_CSRunbks_Pcntrl_Prod" value="" />
			<add key="App_CSRunbks_Pcntrl_Test" value="" />
			<add key="App_CSRunbks_View_Prod" value="" />
			<add key="App_CSRunbks_View_Test" value="" />
		</FabrikamAirlinesWebSite>
	</appRoleDefinitions>
	<applicationSettings>
		<AHTD.Security.Properties.Settings>
			<setting name="ProdMode" serializeAs="String">
				<value>False</value>
			</setting>
		</AHTD.Security.Properties.Settings>
	</applicationSettings>
	<system.serviceModel>
		<services>
			<service name="Microsoft.IdentityModel.Protocols.WSTrust.WSTrustServiceContract" behaviorConfiguration="stsBehavior">
				<endpoint address="IWSTrust13" binding="ws2007HttpBinding" bindingConfiguration="ws2007HttpBindingConfiguration"
					contract="Microsoft.IdentityModel.Protocols.WSTrust.IWSTrust13SyncContract" />
				<endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
				<host>
					<baseAddresses>
					<add baseAddress="http://localhost/stsweb/Services/STSService.svc" />
					</baseAddresses>
				</host>
			</service>
			<service name="AHTD.Security.Web.Services.ClaimsService" behaviorConfiguration="AHTD.Security.Web.Services.ClaimsServiceBehavior">
				<endpoint address="" binding="ws2007FederationHttpBinding" bindingConfiguration="AHTD.Security.Common.ClaimsService_ws2007FederationHttpBinding"
					contract="AHTD.Security.Common.IClaimsService" />
				<endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
				<host>
					<baseAddresses>
					<add baseAddress="http://localhost/stsweb/Services/ClaimsService.svc" />
					</baseAddresses>
				</host>
			</service>
		</services>
		<extensions>
			<behaviorExtensions>
				<add name="federatedServiceHostConfiguration" type="Microsoft.IdentityModel.Configuration.ConfigureServiceHostBehaviorExtensionElement, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
			</behaviorExtensions>
		</extensions>
		<bindings>
			<ws2007HttpBinding>
				<binding name="ws2007HttpBindingConfiguration">
					<security mode="Message">
						<message clientCredentialType="Windows" establishSecurityContext="false"/>
					</security>
				</binding>
			</ws2007HttpBinding>
			<ws2007FederationHttpBinding>
				<binding name="AHTD.Security.Common.ClaimsService_ws2007FederationHttpBinding">
					<security mode="Message">
						<message>
							<issuerMetadata address="http://localhost/stsweb/mex" />
							<claimTypeRequirements>
								<add claimType="http://schemas.microsoft.com/ws/2008/06/identity/claims/windowsaccountname" isOptional="false" />
								<add claimType="http://schemas.microsoft.com/ws/2008/06/identity/claims/role" isOptional="false" />
								<!--<add claimType="http://schemas.arkansashighways.com/ws/identity/claims/ahpdistrict" isOptional="true" />-->
								<!--<add claimType="http://schemas.arkansashighways.com/ws/identity/claims/ahprank" isOptional="true" />-->
								<!--<add claimType="http://schemas.arkansashighways.com/ws/identity/claims/ahprankabbr" isOptional="true" />-->
								<!--<add claimType="http://schemas.arkansashighways.com/ws/identity/claims/ahpunit" isOptional="true" />-->
							</claimTypeRequirements>
						</message>
					</security>
				</binding>
			</ws2007FederationHttpBinding>
		</bindings>
		<behaviors>
			<serviceBehaviors>
				<behavior name="AHTD.Security.Web.Services.ClaimsServiceBehavior">
					<federatedServiceHostConfiguration />
					<serviceMetadata httpGetEnabled="true" />
					<serviceDebug includeExceptionDetailInFaults="false" />
					<serviceCredentials>
						<serviceCertificate findValue="8E2D311F14F4110DAFEA2A05528A62F812D7730A"
							storeLocation="LocalMachine" storeName="My" x509FindType="FindByThumbprint" />
					</serviceCredentials>
				</behavior>
				<behavior name="stsBehavior">
					<serviceMetadata httpGetEnabled="true" />
					<serviceDebug includeExceptionDetailInFaults="true" />
					<serviceCredentials>
						<windowsAuthentication includeWindowsGroups="true" allowAnonymousLogons="false" />
					</serviceCredentials>
				</behavior>
				<behavior name="AHTD.Security.Web.Services.STSServiceBehavior">
					<serviceMetadata httpGetEnabled="true" />
					<serviceDebug includeExceptionDetailInFaults="false" />
				</behavior>
			</serviceBehaviors>
		</behaviors>
	</system.serviceModel>
</configuration>